import{h as s,f as I,j as n,g as r,u as D}from"./vendor.23ef3ccf.js";import{S as G,A as C,f as A,u as B,a as T,b,c as x,d as y}from"./add.67884297.js";import{s as F,a as L,b as N,c as f,d as j,f as P,i as $}from"./index.114a8bc7.js";import{R as k}from"./RecommendList.e2c52d43.js";import"./styled-components.browser.esm.ec6bb831.js";const E=t=>s("div",{className:"navBar__container",children:s("div",{className:"navBar__container-title",children:"\u8D2D\u7269\u8F66"})});var w="/assets/enpty_cart.1276a6bb.png",R="/assets/selected.c4341689.png";const q=t=>{let{goodData:e={},compressedData:a,selectedGoods:c,totalNum:i,totalAccount:l,isSelected:d}=t;const{setTotalNum:m,setTotalAccount:u,setCartInfo:g,setCompressedData:_,setIsSelected:v}=t;console.log(d,"----");const p=(o,S)=>{S>0?(a[o.id]=a[o.id]>0?a[o.id]+1:1,u(A(l,S)),m(i+1),c=B([o,...c])):(a[o.id]=a[o.id]>0?a[o.id]-1:1,a[o.id]==0&&(delete a[o.id],c=T(o,c)),u(b(l,-S)),m(i-1)),_(a),g(c)},h=o=>{console.log(d[o],"++++"),d[o]=!d[o],v(d)};return n("div",{className:"selectedGoodsItem",children:[s("div",{className:"selectedGoodsItem__selectButton",children:d[e.id]?s("div",{className:"isSelected",onClick:()=>h(e.id),children:s("img",{src:R})}):s("div",{className:"isSelected",onClick:()=>h(e.id),children:s("div",{className:"noSeleted"})})}),s("div",{className:"selectedGoodsItem__img",children:s("img",{src:e.imgsrc})}),n("div",{className:"selectedGoodsItem__goodsInfo",children:[n("div",{className:"selectedGoodsItem__goodsInfo_title",children:[e.tags.map(o=>s("div",{className:"tag",children:o},o)),e.title]}),s("div",{className:"selectedGoodsItem__goodsInfo_trade",children:e.tradeDescription}),n("div",{className:"selectedGoodsItem__goodsInfo_price",children:["\uFFE5",e.price]}),n("div",{className:"selectedGoodsItem__goodsInfo_buttom",children:[s("img",{src:G,className:"subButtom",onClick:()=>p(e,-e.price)}),s("div",{className:"goodsNum",children:a[e.id]}),s("img",{src:C,className:"addButtom",onClick:()=>p(e,e.price)})]})]})]})},U=t=>({selectedGoods:t.main.selectedGoods,totalAccount:t.main.totalAccount,compressedData:t.main.compressedData,totalNum:t.main.totalNum,isSelected:t.main.isSelected}),H=t=>({setCompressedData(e){t(F(e))},setIsSelected(e){t(L(e))},setCartInfo(e){t(N(e))},setTotalAccount(e){t(f(e))},setTotalNum(e){t(j(e))}});var z=I(U,H)(q);const J=t=>{const{selectedGoodsData:e=[]}=t,{setCartInfo:a,goToShopping:c}=t;return s("div",{className:"GoodsList__container",children:e.length?s("div",{className:"container-goodsList",children:e.map((i,l)=>s(z,{goodData:i,changeCartInfo:a},l))}):n("div",{className:"container-empty_cart",children:[s("img",{src:w,className:"empty_cart__icon"}),s("div",{className:"empty_cart__desc",children:"\u60A8\u7684\u8D2D\u7269\u8F66\u8FD8\u662F\u7A7A\u7684\uFF0C\u5FEB\u53BB\u901B\u901B\u5427"}),s("div",{className:"empty_cart__button",onClick:()=>c(),children:"\u53BB\u901B\u901B"})]})})};const K=t=>{const{selectedGoods:e,totalAccount:a}=t;let[c,i]=r.exports.useState(1);const[l,d]=r.exports.useState([]),{getIndexDispatch:m,getSelectedGoodsDisPatch:u,getTotalAccountDispatch:g}=t,_=D(),v=()=>{i(++c)},p=()=>{},h=async()=>{await $(c).then(o=>{d([...l,...o.data.data.list])})};return r.exports.useEffect(()=>{h()},[c]),r.exports.useEffect(()=>{m(2)},[]),n("div",{className:"cart__container",children:[s(E,{}),s(x,{direction:"vertical",refresh:!1,pullUp:v,pullDown:p,onScroll:()=>{y()},children:n("div",{children:[s(J,{selectedGoodsData:e,setCartInfo:u,goToShopping:()=>_.push("/home/main")}),s(k,{recommendList:l})]})})]})},M=t=>({selectedGoods:t.main.selectedGoods,totalAccount:t.main.totalAccount}),O=t=>({getIndexDispatch(e){t(P(e))},getSelectedGoodsDisPatch(e){t(N(e))},getTotalAccountDispatch(e){t(f(e))}});var Z=I(M,O)(r.exports.memo(K));export{Z as default};
